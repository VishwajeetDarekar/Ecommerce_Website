<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="navbar"></div>

<script src="config.js"></script>
<script>
fetch("navbar.html")
    .then(res => res.text())
    .then(data => document.getElementById("navbar").innerHTML = data);
</script>

<section class="product-details">
    <div class="product-image-box">
        <img id="image">
    </div>

    <div class="product-info-box">
        <h1 id="name">Loading...</h1>
        <p id="price" class="p-price"></p>
        <p id="desc" class="p-desc"></p>

        <button class="btn" id="addCart">Add to Cart</button>
    </div>
</section>

<script>
let productId = new URLSearchParams(window.location.search).get("id");

async function loadProduct() {
    const res = await fetch(`${API_URL}/products/${productId}`);
    const p = await res.json();

    document.getElementById("name").innerText = p.name;
    document.getElementById("image").src = p.image;
    document.getElementById("price").innerText = "â‚¹" + p.price;
    document.getElementById("desc").innerText = p.description;
}

document.getElementById("addCart").addEventListener("click", async () => {
    const token = localStorage.getItem("token");
    if (!token) return alert("Please login first!");

    await fetch(`${API_URL}/cart/add`, {
        method: "POST",
        headers: { "Content-Type": "application/json", "Authorization": "Bearer " + token },
        body: JSON.stringify({ productId })
    });

    alert("Added to cart!");
});

loadProduct();
</script>

</body>
</html>
